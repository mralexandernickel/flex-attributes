import * as CONSTANTS from '../configs/Constants';

class StylesheetsService {

  private head: HTMLHeadElement = document.head;
  private stylesheets: Array<String> = CONSTANTS.STYLESHEETS;
  private stylesheetsLoaded: number = 0;
  private classLoaded: string = 'css-ready';

  constructor() {
    this.get();
  }

  injectStylesheet(url) {
    let resource = document.createElement('link');
    resource.setAttribute('rel', 'stylesheet');
    resource.setAttribute('href', url);
    resource.addEventListener('load', () => {
      this.stylesheetsLoaded++;
      if (this.stylesheetsLoaded === this.stylesheets.length) {
        document.body.classList.add(this.classLoaded);
      }
    });
    this.head.appendChild(resource);
  }

  get() {
    for (var i = 0;i < this.stylesheets.length;i++) {
      this.injectStylesheet(this.stylesheets[i]);
    }
  }
}

export default StylesheetsService;